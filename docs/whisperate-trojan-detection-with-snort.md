\#Snort Malware Detection Example

\#\#Overview  
This document showcases an example of snort detecting malware from network traffic. In this case, it is analyzing network traffic from a pcap file 

\#\#Environment Setup

- System used: WSL Ubuntu   
- Snort version: snort3

\#\#Detection Demonstration

\#\#\#Step 1: Analyzing the PCAP file

![Detecting a trojan virus from a pcap file](docs/whisper-trojan-detect-with-snort.png)


The command used: bash snort \-c /usr/local/etc/snort/snort.lua \--plugin-path /usr/local/etc/so\_rules/ \-r 2022-02-23-traffic-analysis-exercise.pcap \-A alert\_fast \-q \> pcap-signatures.txt

\#\#\#Step 2: Examining results

Command used: grep \-i malware pcap-signatures.txt

This command filters the output for any alert that detected something malicious. In this case, it detected “Win.Trojan.WhisperGate”, a network trojan virus.

[image1]: <data:image/png;base64,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>